**js/auth.js**
```javascript
class AuthManager {
    constructor() {
        this.baseURL = '';
        this.token = localStorage.getItem('auth_token');
        this.tempToken = localStorage.getItem('temp_token');
    }

    // API Helper Methods
    async apiCall(endpoint, method = 'GET', data = null, useToken = true) {
        const options = {
            method,
            headers: {
                'Content-Type': 'application/json',
            }
        };

        if (useToken && this.token) {
            options.headers['Authorization'] = `Bearer ${this.token}`;
        }

        if (data) {
            options.body = JSON.stringify(data);
        }

        try {
            const response = await fetch(`${this.baseURL}/api${endpoint}`, options);
            const result = await response.json();
            
            if (!response.ok) {
                throw new Error(result.error || 'Request failed');
            }
            
            return result;
        } catch (error) {
            console.error('API Error:', error);
            throw error;
        }
    }

    // Authentication Methods
    async register(username, email, password) {
        try {
            const result = await this.apiCall('/register', 'POST', {
                username,
                email,
                password
            }, false);
            
            return result;
        } catch (error) {
            throw new Error(error.message || 'Registration failed');
        }
    }

    async login(username, password) {
        try {
            const result = await this.apiCall('/login', 'POST', {
                username,
                password
            }, false);
            
            if (result.mfaRequired) {
                this.tempToken = result.tempToken;
                localStorage.setItem('temp_token', this.tempToken);
                return { mfaRequired: true, tempToken: result.tempToken };
            } else {
                this.token = result.token;
                localStorage.setItem('auth_token', this.token);
                localStorage.removeItem('temp_token');
                return { success: true, token: result.token };
            }
        } catch (error) {
            throw new Error(error.message || 'Login failed');
        }
    }

    async sendEmailOTP() {
        if (!this.tempToken) {
            throw new Error('No temporary token available');
        }

        try {
            const result = await this.apiCall('/send-email-otp', 'POST', {
                tempToken: this.tempToken
            }, false);
            
            return result;
        } catch (error) {
            throw new Error(error.message || 'Failed to send OTP');
        }
    }

    async verifyMFA(code, method = 'totp') {
        if (!this.tempToken) {
            throw new Error('No temporary token available');
        }

        try {
            const result = await this.apiCall('/verify-mfa', 'POST', {
                tempToken: this.tempToken,
                code,
                method
            }, false);
            
            this.token = result.token;
            localStorage.setItem('auth_token', this.token);
            localStorage.removeItem('temp_token');
            this.tempToken = null;
            
            return result;
        } catch (error) {
            throw new Error(error.message || 'MFA verification failed');
        }
    }

    async setupTOTP() {
        try {
            const result = await this.apiCall('/setup-totp', 'POST', {});
            return result;
        } catch (error) {
            throw new Error(error.message || 'TOTP setup failed');
        }
    }

    async verifyTOTPSetup(token) {
        try {
            const result = await this.apiCall('/verify-totp-setup', 'POST', {
                token
            });
            return result;
        } catch (error) {
            throw new Error(error.message || 'TOTP verification failed');
        }
    }

    async getProfile() {
        try {
            const result = await this.apiCall('/profile');
            return result;
        } catch (error) {
            throw new Error(error.message || 'Failed to get profile');
        }
    }

    // Utility Methods
    isAuthenticated() {
        return !!this.token;
    }

    hasTempToken() {
        return !!this.tempToken;
    }

    logout() {
        this.token = null;
        this.tempToken = null;
        localStorage.removeItem('auth_token');
        localStorage.removeItem('temp_token');
        window.location.href = '/';
    }

    // UI Helper Methods
    showAlert(message, type = 'info') {
        const alertContainer = document.getElementById('alert-container');
        if (!alertContainer) return;

        const alert = document.createElement('div');
        alert.className = `alert alert-${type}`;
        alert.textContent = message;
        
        alertContainer.innerHTML = '';
        alertContainer.appendChild(alert);
        
        // Auto-hide after 5 seconds
        setTimeout(() => {
            if (alert.parentNode) {
                alert.parentNode.removeChild(alert);
            }
        }, 5000);
    }

    showLoading(button, show = true) {
        if (show) {
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span> Loading...';
        } else {
            button.disabled = false;
            button.innerHTML = button.getAttribute('data-original-text') || 'Submit';
        }
    }

    setOriginalButtonText(button) {
        button.setAttribute('data-original-text', button.textContent);
    }
}

// Global instance
const authManager = new AuthManager();
```

### **3.3 MFA Specific JavaScript (45 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**js/mfa.js**
```javascript
class MFAManager {
    constructor(authManager) {
        this.auth = authManager;
        this.selectedMethod = null;
        this.qrCodeData = null;
        this.backupCodes = null;
    }

    // TOTP Methods
    async setupTOTP() {
        try {
            const result = await this.auth.setupTOTP();
            this.qrCodeData = result.qrCode;
            this.backupCodes = result.backupCodes;
            
            this.displayQRCode(result.qrCode);
            this.displayBackupCodes(result.backupCodes);
            
            return result;
        } catch (error) {
            this.auth.showAlert(error.message, 'error');
            throw error;
        }
    }

    async verifyTOTPSetup(token) {
        try {
            const result = await this.auth.verifyTOTPSetup(token);
            this.auth.showAlert('TOTP setup completed successfully!', 'success');
            return result;
        } catch (error) {
            this.auth.showAlert(error.message, 'error');
            throw error;
        }
    }

    displayQRCode(qrCodeDataURL) {
        const container = document.getElementById('qr-code-container');
        if (!container) return;

        container.innerHTML = `
            <h3>Scan QR Code with your Authenticator App</h3>
            <img src="${qrCodeDataURL}" alt="QR Code" style="max-width: 256px;">
            <p class="text-muted mt-3">
                Scan this QR code with Google Authenticator, Authy, or any compatible TOTP app.
            </p>
        `;
    }

    displayBackupCodes(codes) {
        const container = document.getElementById('backup-codes-container');
        if (!container) return;

        const codesHTML = codes.map(code => 
            `<div class="backup-code">${code}</div>`
        ).join('');

        container.innerHTML = `
            <div class="backup-codes">
                <h3>Backup Codes</h3>
                <p class="text-muted">
                    Save these backup codes in a safe place. Each code can only be used once.
                </p>
                <div class="backup-codes-grid">
                    ${codesHTML}
                </div>
                <div class="alert alert-warning mt-3">
                    <strong>Important:</strong> Store these codes securely. You'll need them if you lose access to your authenticator app.
                </div>
            </div>
        `;
    }

    // MFA Verification Methods
    setupMFAOptions() {
        const container = document.getElementById('mfa-options');
        if (!container) return;

        container.innerHTML = `
            <div class="mfa-option" data-method="totp">
                <h3>üì± Authenticator App</h3>
                <p>Use Google Authenticator or similar app</p>
            </div>
            <div class="mfa-option" data-method="email">
                <h3>üìß Email Code</h3>
                <p>Receive a code via email</p>
            </div>
            <div class="mfa-option" data-method="backup">
                <h3>üîë Backup Code</h3>
                <p>Use a saved backup code</p>
            </div>
        `;

        // Add click handlers
        container.querySelectorAll('.mfa-option').forEach(option => {
            option.addEventListener('click', () => {
                this.selectMFAMethod(option.dataset.method);
            });
        });
    }

    selectMFAMethod(method) {
        this.selectedMethod = method;
        
        // Update UI
        document.querySelectorAll('.mfa-option').forEach(option => {
            option.classList.remove('selected');
        });
        
        document.querySelector(`[data-method="${method}"]`).classList.add('selected');
        
        // Show appropriate input form
        this.showMFAInput(method);
    }

    showMFAInput(method) {
        const container = document.getElementById('mfa-input-container');
        if (!container) return;

        let inputHTML = '';
        let placeholder = '';
        let buttonText = 'Verify';

        switch (method) {
            case 'totp':
                placeholder = 'Enter 6-digit code from your app';
                inputHTML = `
                    <input type="number" id="mfa-code" placeholder="${placeholder}" 
                           maxlength="6" minlength="6" required>
                `;
                break;
            case 'email':
                placeholder = 'Enter code from email';
                inputHTML = `
                    <div class="flex gap-2 mb-3">
                        <button type="button" id="send-email-otp" class="btn btn-secondary">
                            Send Email Code
                        </button>
                    </div>
                    <input type="number" id="mfa-code" placeholder="${placeholder}" 
                           maxlength="6" minlength="6" required disabled>
                `;
                break;
            case 'backup':
                placeholder = 'Enter backup code';
                inputHTML = `
                    <input type="text" id="mfa-code" placeholder="${placeholder}" 
                           maxlength="8" minlength="8" required style="text-transform: uppercase;">
                `;
                break;
        }

        container.innerHTML = `
            <div class="form-group">
                <label for="mfa-code">Verification Code</label>
                ${inputHTML}
            </div>
            <button type="submit" class="btn btn-primary btn-block" id="verify-mfa">
                ${buttonText}
            </button>
        `;

        // Add event listeners
        if (method === 'email') {
            document.getElementById('send-email-otp').addEventListener('click', () => {
                this.sendEmailOTP();
            });
        }

        document.getElementById('verify-mfa').addEventListener('click', (e) => {
            e.preventDefault();
            this.verifyMFA();
        });

        // Focus on input
        document.getElementById('mfa-code').focus();
    }

    async sendEmailOTP() {
        const button = document.getElementById('send-email-otp');
        const codeInput = document.getElementById('mfa-code');
        
        this.auth.setOriginalButtonText(button);
        this.auth.showLoading(button);

        try {
            await this.auth.sendEmailOTP();
            this.auth.showAlert('Email sent! Check your inbox for the verification code.', 'success');
            
            // Enable code input
            codeInput.disabled = false;
            codeInput.focus();
            
            // Update button text
            button.textContent = 'Resend Code';
            
        } catch (error) {
            this.auth.showAlert(error.message, 'error');
        } finally {
            this.auth.showLoading(button, false);
        }
    }

    async verifyMFA() {
        const button = document.getElementById('verify-mfa');
        const codeInput = document.getElementById('mfa-code');
        const code = codeInput.value.trim();

        if (!code) {
            this.auth.showAlert('Please enter the verification code', 'error');
            return;
        }

        if (!this.selectedMethod) {
            this.auth.showAlert('Please select a verification method', 'error');
            return;
        }

        this.auth.setOriginalButtonText(button);
        this.auth.showLoading(button);

        try {
            const result = await this.auth.verifyMFA(code, this.selectedMethod);
            this.auth.showAlert('Login successful! Redirecting...', 'success');
            
            setTimeout(() => {
                window.location.href = '/dashboard.html';
            }, 1500);
            
        } catch (error) {
            this.auth.showAlert(error.message, 'error');
            codeInput.value = '';
            codeInput.focus();
        } finally {
            this.auth.showLoading(button, false);
        }
    }

    // Format input for better UX
    formatTOTPInput(input) {
        input.addEventListener('input', (e) => {
            // Remove non-digits
            e.target.value = e.target.value.replace(/\D/g, '');
            
            // Limit to 6 digits
            if (e.target.value.length > 6) {
                e.target.value = e.target.value.slice(0, 6);
            }
        });
    }

    formatBackupCodeInput(input) {
        input.addEventListener('input', (e) => {
            // Convert to uppercase and remove non-alphanumeric
            e.target.value = e.target.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
            
            // Limit to 8 characters
            if (e.target.value.length > 8) {
                e.target.value = e.target.value.slice(0, 8);
            }
        });
    }

    // Countdown timer for email OTP
    startCountdown(button, seconds = 60) {
        let timeLeft = seconds;
        button.disabled = true;
        
        const timer = setInterval(() => {
            button.textContent = `Resend in ${timeLeft}s`;
            timeLeft--;
            
            if (timeLeft < 0) {
                clearInterval(timer);
                button.disabled = false;
                button.textContent = 'Resend Code';
            }
        }, 1000);
    }
}

// Global instance
const mfaManager = new MFAManager(authManager);
```

### **3.4 HTML Pages (90 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**public/index.html**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MFA Lab - Home</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>üîê Multi-Factor Authentication Lab</h1>
                <p>Learn and practice MFA implementation</p>
            </div>
            
            <div id="alert-container"></div>
            
            <div class="text-center">
                <div class="mfa-options">
                    <div class="mfa-option">
                        <h3>üë§ Login</h3>
                        <p>Access your account</p>
                        <a href="/login.html" class="btn btn-primary">Login</a>
                    </div>
                    
                    <div class="mfa-option">
                        <h3>üìù Register</h3>
                        <p>Create a new account</p>
                        <a href="/register.html" class="btn btn-secondary">Register</a>
                    </div>
                </div>
                
                <div class="mt-3">
                    <h3>About This Lab</h3>
                    <p class="text-muted">
                        This lab demonstrates implementation of Multi-Factor Authentication using:
                    </p>
                    <ul style="text-align: left; max-width: 400px; margin: 20px auto;">
                        <li>üîë TOTP (Time-based One-Time Password)</li>
                        <li>üìß Email-based OTP</li>
                        <li>üõ°Ô∏è Backup Codes</li>
                        <li>üîí Secure Session Management</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script>
        // Check if already logged in
        if (authManager.isAuthenticated()) {
            window.location.href = '/dashboard.html';
        }
    </script>
</body>
</html>
```

**public/register.html**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - MFA Lab</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>üìù Create Account</h1>
                <p>Register for MFA Lab</p>
            </div>
            
            <div id="alert-container"></div>
            
            <form id="register-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required 
                           minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+">
                    <small class="text-muted">3-20 characters, letters, numbers, and underscore only</small>
                </div>
                
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required minlength="8">
                    <small class="text-muted">Minimum 8 characters</small>
                </div>
                
                <div class="form-group">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" name="confirm-password" required>
                </div>
                
                <button type="submit" class="btn btn-primary btn-block" id="register-btn">
                    Create Account
                </button>
            </form>
            
            <div class="text-center mt-3">
                <p>Already have an account? <a href="/login.html">Login here</a></p>
                <p><a href="/">‚Üê Back to Home</a></p>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script>
        document.getElementById('register-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const button = document.getElementById('register-btn');
            const username = document.getElementById('username').value.trim();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // Validation
            if (password !== confirmPassword) {
                authManager.showAlert('Passwords do not match', 'error');
                return;
            }
            
            if (password.length < 8) {
                authManager.showAlert('Password must be at least 8 characters', 'error');
                return;
            }
            
            authManager.setOriginalButtonText(button);
            authManager.showLoading(button);
            
            try {
                await authManager.register(username, email, password);
                authManager.showAlert('Account created successfully! You can now login.', 'success');
                
                setTimeout(() => {
                    window.location.href = '/login.html';
                }, 2000);
                
            } catch (error) {
                authManager.showAlert('Verification failed: ' + error.message, 'error');
            } finally {
                authManager.showLoading(button, false);
            }
        });
        
        // Cancel Setup Handler
        document.getElementById('cancel-setup-btn').addEventListener('click', () => {
            document.getElementById('mfa-setup-process').classList.add('hidden');
            document.getElementById('mfa-setup-section').classList.remove('hidden');
            document.getElementById('setup-verification-code').value = '';
        });
        
        // Logout Handler
        document.getElementById('logout-btn').addEventListener('click', () => {
            if (confirm('Are you sure you want to logout?')) {
                authManager.logout();
            }
        });
        
        // Format verification code input
        const setupCodeInput = document.getElementById('setup-verification-code');
        mfaManager.formatTOTPInput(setupCodeInput);
    </script>
</body>
</html>
```

### **‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á frontend
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö responsive design
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö user flow ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

---

## üß™ **Part 4: Testing ‡πÅ‡∏•‡∏∞ Debugging (1.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)**

### **4.1 Testing Plan (45 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:**

**1. User Registration Flow**
```bash
# Test via curl
curl -X POST http://localhost:3000/api/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "SecurePass123!"
  }'
```

**2. Login without MFA**
```bash
# Test login
curl -X POST http://localhost:3000/api/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "SecurePass123!"
  }'
```

**3. TOTP Setup Flow**
```bash
# Get profile (need to include token from previous response)
curl -X GET http://localhost:3000/api/profile \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"

# Setup TOTP
curl -X POST http://localhost:3000/api/setup-totp \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -H "Content-Type: application/json"
```

**4. MFA Login Flow**
- ‡∏•‡∏≠‡∏á login ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏õ‡∏¥‡∏î MFA
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö TOTP verification
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Email OTP
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Backup codes

### **4.2 Common Issues ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (45 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**Environment Variables Setup**

**create .env file:**
```env
# Email Configuration (Gmail)
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password

# JWT Secret
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# Server Configuration
PORT=3000
NODE_ENV=development

# Database
DB_PATH=./mfa_lab.db
```

**Update server.js to use .env:**
```javascript
require('dotenv').config();

// Update JWT_SECRET
const JWT_SECRET = process.env.JWT_SECRET || 'your-super-secret-key';

// Update EmailService constructor
class EmailService {
    constructor() {
        this.transporter = nodemailer.createTransporter({
            service: 'gmail',
            auth: {
                user: process.env.EMAIL_USER,
                pass: process.env.EMAIL_PASS
            }
        });
    }
}
```

**Install dotenv:**
```bash
npm install dotenv
```

**Gmail App Password Setup:**
1. Go to Google Account settings
2. Security > 2-Step Verification
3. App passwords > Generate new app password
4. Use this password in .env file

### **4.3 Security Testing (Optional)**

**Rate Limiting Test:**
```bash
# Test rate limiting by sending multiple failed login attempts
for i in {1..6}; do
  curl -X POST http://localhost:3000/api/login \
    -H "Content-Type: application/json" \
    -d '{"username": "testuser", "password": "wrongpassword"}'
  echo "Attempt $i"
done
```

**JWT Token Validation:**
```bash
# Test with invalid token
curl -X GET http://localhost:3000/api/profile \
  -H "Authorization: Bearer invalid_token"

# Test with expired token
curl -X GET http://localhost:3000/api/profile \
  -H "Authorization: Bearer expired_token"
```

---

## üìã **Part 5: Documentation ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô (1.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)**

### **5.1 README.md**

**README.md**
```markdown
# MFA Lab - Multi-Factor Authentication Implementation

## Overview
This project demonstrates the implementation of Multi-Factor Authentication (MFA) using Node.js backend and vanilla JavaScript frontend.

## Features
- User Registration and Login
- Password-based Authentication
- TOTP (Time-based One-Time Password) via Authenticator Apps
- Email-based OTP
- Backup Codes
- Rate Limiting
- Secure Session Management
- JWT Token Authentication

## Technology Stack
- **Backend**: Node.js, Express.js, SQLite
- **Frontend**: HTML5, CSS3, Vanilla JavaScript
- **MFA**: Speakeasy (TOTP), Nodemailer (Email OTP)
- **Security**: bcrypt, jsonwebtoken

## Installation

1. Clone the repository
```bash
git clone <repository-url>
cd mfa-lab
```

2. Install dependencies
```bash
npm install
```

3. Create environment file
```bash
cp .env.example .env
# Edit .env with your email credentials
```

4. Start the server
```bash
npm run dev
```

5. Open browser to `http://localhost:3000`

## Configuration

### Email Setup (Gmail)
1. Enable 2-Factor Authentication on your Gmail account
2. Generate an App Password
3. Update .env file with your credentials

### Environment Variables
- `EMAIL_USER`: Your Gmail address
- `EMAIL_PASS`: Gmail app password
- `JWT_SECRET`: Secret key for JWT tokens
- `PORT`: Server port (default: 3000)

## Usage

### 1. Register Account
- Go to `/register.html`
- Create account with username, email, password

### 2. Login (First Time)
- Login with username/password
- Account will be logged in without MFA

### 3. Setup MFA
- Go to Dashboard
- Click "Setup MFA (TOTP)"
- Scan QR code with authenticator app
- Save backup codes
- Verify setup with 6-digit code

### 4. Login with MFA
- Login with username/password
- Choose verification method:
  - Authenticator app (TOTP)
  - Email code
  - Backup code
- Enter verification code

## API Endpoints

### Authentication
- `POST /api/register` - Register new user
- `POST /api/login` - User login
- `GET /api/profile` - Get user profile (protected)

### MFA Management
- `POST /api/setup-totp` - Setup TOTP MFA
- `POST /api/verify-totp-setup` - Verify TOTP setup
- `POST /api/send-email-otp` - Send email OTP
- `POST /api/verify-mfa` - Verify MFA code

## Security Features

### Rate Limiting
- 5 failed login attempts per IP/username per 15 minutes
- Automatic lockout with cooldown period

### Password Security
- Minimum 8 characters
- bcrypt hashing with salt rounds
- Server-side validation

### Token Security
- JWT tokens with expiration
- Temporary tokens for MFA process
- Secure token storage

### TOTP Security
- 30-second time window
- 6-digit codes
- Base32 secret encoding
- Backup codes for recovery

## Testing

### Manual Testing
1. Register multiple users
2. Test login flows
3. Test MFA setup and verification
4. Test backup codes
5. Test rate limiting

### API Testing
```bash
# Register user
curl -X POST http://localhost:3000/api/register \
  -H "Content-Type: application/json" \
  -d '{"username": "test", "email": "test@example.com", "password": "password123"}'

# Login
curl -X POST http://localhost:3000/api/login \
  -H "Content-Type: application/json" \
  -d '{"username": "test", "password": "password123"}'
```

## Troubleshooting

### Common Issues
1. **Email not sending**: Check Gmail app password and .env configuration
2. **TOTP codes not working**: Verify time synchronization on device
3. **Database errors**: Delete `mfa_lab.db` and restart server
4. **Rate limiting**: Wait 15 minutes or restart server

### Debug Mode
```bash
NODE_ENV=development npm run dev
```

## Security Considerations

### Production Deployment
- Use environment variables for all secrets
- Enable HTTPS
- Implement proper session management
- Add CSRF protection
- Use database connection pooling
- Add logging and monitoring
- Implement backup and recovery

### Known Limitations
- SQLite database (use PostgreSQL/MySQL in production)
- In-memory session storage
- No CSRF protection
- No password complexity validation
- No account recovery mechanism

## Learning Objectives
- Understanding MFA principles
- TOTP implementation
- Email-based verification
- Secure authentication flows
- JWT token management
- Rate limiting techniques
- Security best practices

## License
MIT License - For educational purposes only
```

### **5.2 Lab Report Template**

**Lab Report Structure:**

**1. Executive Summary (1 ‡∏´‡∏ô‡πâ‡∏≤)**
- ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á Lab
- Technology stack ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ

**2. Implementation Details (3-4 ‡∏´‡∏ô‡πâ‡∏≤)**
- **Backend Architecture**
  - Database schema ‡πÅ‡∏•‡∏∞ relationships
  - API endpoints ‡πÅ‡∏•‡∏∞ functionality
  - Security measures implemented
  
- **Frontend Design**
  - User interface design decisions
  - User experience flow
  - JavaScript implementation approach

- **MFA Implementation**
  - TOTP setup and verification process
  - Email OTP implementation
  - Backup codes system

**3. Security Analysis (2-3 ‡∏´‡∏ô‡πâ‡∏≤)**
- **Authentication Security**
  - Password hashing and storage
  - JWT token management
  - Session security
  
- **MFA Security Features**
  - TOTP security considerations
  - Rate limiting implementation
  - Backup code security
  
- **Vulnerability Assessment**
  - Known security limitations
  - Potential attack vectors
  - Mitigation strategies

**4. Testing Results (1-2 ‡∏´‡∏ô‡πâ‡∏≤)**
- **Functional Testing**
  - User registration and login
  - MFA setup and verification
  - Error handling
  
- **Security Testing**
  - Rate limiting verification
  - Token validation testing
  - Input validation testing

**5. Challenges ‡πÅ‡∏•‡∏∞ Solutions (1 ‡∏´‡∏ô‡πâ‡∏≤)**
- ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤
- ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤
- ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

**6. Improvements ‡πÅ‡∏•‡∏∞ Next Steps (1 ‡∏´‡∏ô‡πâ‡∏≤)**
- ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥
- Features ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à
- ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á

### **5.3 ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô**

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á:**
1. **Source Code** (ZIP file)
   - ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ Node.js ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
   - README.md ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
   - .env.example file

2. **Lab Report** (PDF)
   - ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
   - Screenshots ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
   - Code snippets ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

3. **Demo Video** (MP4, ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏ô‡∏≤‡∏ó‡∏µ)
   - ‡∏Å‡∏≤‡∏£ register user
   - ‡∏Å‡∏≤‡∏£ setup MFA
   - ‡∏Å‡∏≤‡∏£ login ‡∏î‡πâ‡∏ß‡∏¢ MFA ‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ
   - ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ backup codes

**‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô (100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô):**
- **Implementation (50 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)**
  - Backend functionality: 25 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  - Frontend functionality: 25 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  
- **Security (25 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)**
  - MFA implementation: 15 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  - Security best practices: 10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  
- **Documentation (15 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)**
  - Code quality ‡πÅ‡∏•‡∏∞ comments: 8 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  - README ‡πÅ‡∏•‡∏∞ setup instructions: 7 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  
- **Report ‡πÅ‡∏•‡∏∞ Demo (10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)**
  - Lab report quality: 5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
  - Demo video: 5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô

**‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á:** ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 2 ‡∏ß‡∏±‡∏ô (48 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)

---

## üéØ **‡∏™‡∏£‡∏∏‡∏õ Lab Learning Outcomes**

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥ Lab ‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ:

1. **‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ MFA** - ‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á authentication factors ‡∏ï‡πà‡∏≤‡∏á‡πÜ
2. **‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤** - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á full-stack application ‡∏î‡πâ‡∏ß‡∏¢ Node.js ‡πÅ‡∏•‡∏∞ vanilla JavaScript
3. **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏î‡πâ‡∏≤‡∏ô Security** - ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à JWT, password hashing, rate limiting
4. **‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á** - ‡πÑ‡∏î‡πâ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô TOTP, Email OTP, ‡πÅ‡∏•‡∏∞ backup codes
5. **Best Practices** - ‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö authentication ‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

Lab ‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö software engineers ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ MFA ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î) {
                authManager.showAlert(error.message, 'error');
            } finally {
                authManager.showLoading(button, false);
            }
        });
        
        // Password confirmation validation
        document.getElementById('confirm-password').addEventListener('input', (e) => {
            const password = document.getElementById('password').value;
            const confirmPassword = e.target.value;
            
            if (confirmPassword && password !== confirmPassword) {
                e.target.setCustomValidity('Passwords do not match');
            } else {
                e.target.setCustomValidity('');
            }
        });
    </script>
</body>
</html>
```

**public/login.html**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - MFA Lab</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1 id="page-title">üîê Login</h1>
                <p id="page-subtitle">Enter your credentials</p>
            </div>
            
            <div id="alert-container"></div>
            
            <!-- Step 1: Username and Password -->
            <div id="login-step" class="login-step">
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block" id="login-btn">
                        Login
                    </button>
                </form>
            </div>
            
            <!-- Step 2: MFA Verification -->
            <div id="mfa-step" class="login-step hidden">
                <div id="mfa-options"></div>
                <div id="mfa-input-container"></div>
            </div>
            
            <div class="text-center mt-3">
                <p>Don't have an account? <a href="/register.html">Register here</a></p>
                <p><a href="/">‚Üê Back to Home</a></p>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/mfa.js"></script>
    <script>
        // Check if already has temp token (MFA required)
        if (authManager.hasTempToken()) {
            showMFAStep();
        }
        
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const button = document.getElementById('login-btn');
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            authManager.setOriginalButtonText(button);
            authManager.showLoading(button);
            
            try {
                const result = await authManager.login(username, password);
                
                if (result.mfaRequired) {
                    authManager.showAlert('Please complete MFA verification', 'info');
                    showMFAStep();
                } else {
                    authManager.showAlert('Login successful! Redirecting...', 'success');
                    setTimeout(() => {
                        window.location.href = '/dashboard.html';
                    }, 1500);
                }
                
            } catch (error) {
                authManager.showAlert(error.message, 'error');
            } finally {
                authManager.showLoading(button, false);
            }
        });
        
        function showMFAStep() {
            document.getElementById('login-step').classList.add('hidden');
            document.getElementById('mfa-step').classList.remove('hidden');
            document.getElementById('page-title').textContent = 'üîê Multi-Factor Authentication';
            document.getElementById('page-subtitle').textContent = 'Choose verification method';
            
            mfaManager.setupMFAOptions();
        }
    </script>
</body>
</html>
```

**public/dashboard.html**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - MFA Lab</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>üè† Dashboard</h1>
                <p>Welcome to your secure area!</p>
            </div>
            
            <div id="alert-container"></div>
            
            <!-- User Profile -->
            <div id="profile-section">
                <h3>üë§ Profile Information</h3>
                <div id="profile-data" class="alert alert-info">
                    Loading profile...
                </div>
            </div>
            
            <!-- MFA Management -->
            <div id="mfa-management" class="mt-3">
                <h3>üîê MFA Settings</h3>
                <div id="mfa-status" class="mb-3"></div>
                
                <div id="mfa-setup-section" class="hidden">
                    <div class="alert alert-warning">
                        <strong>Enhance your security!</strong> Enable MFA to protect your account.
                    </div>
                    <button id="setup-mfa-btn" class="btn btn-primary">
                        Setup MFA (TOTP)
                    </button>
                </div>
                
                <div id="mfa-setup-process" class="hidden">
                    <div id="qr-code-container"></div>
                    <div id="backup-codes-container"></div>
                    
                    <div class="form-group mt-3">
                        <label for="setup-verification-code">Enter code from your app to verify setup:</label>
                        <input type="number" id="setup-verification-code" 
                               placeholder="6-digit code" maxlength="6" minlength="6">
                    </div>
                    
                    <button id="verify-setup-btn" class="btn btn-success">
                        Verify & Complete Setup
                    </button>
                    <button id="cancel-setup-btn" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="text-center mt-3">
                <button id="logout-btn" class="btn btn-warning">
                    üö™ Logout
                </button>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/mfa.js"></script>
    <script>
        // Check authentication
        if (!authManager.isAuthenticated()) {
            window.location.href = '/login.html';
        }
        
        // Load profile data
        loadProfile();
        
        async function loadProfile() {
            try {
                const profile = await authManager.getProfile();
                
                document.getElementById('profile-data').innerHTML = `
                    <strong>Username:</strong> ${profile.username}<br>
                    <strong>Email:</strong> ${profile.email}<br>
                    <strong>Member since:</strong> ${new Date(profile.createdAt).toLocaleDateString()}<br>
                    <strong>MFA Status:</strong> ${profile.mfaEnabled ? '‚úÖ Enabled' : '‚ùå Disabled'}
                `;
                
                // Show MFA setup if not enabled
                if (!profile.mfaEnabled) {
                    document.getElementById('mfa-status').innerHTML = `
                        <div class="alert alert-warning">
                            <strong>MFA is not enabled.</strong> Your account is less secure without MFA.
                        </div>
                    `;
                    document.getElementById('mfa-setup-section').classList.remove('hidden');
                } else {
                    document.getElementById('mfa-status').innerHTML = `
                        <div class="alert alert-success">
                            <strong>MFA is enabled.</strong> Your account is protected with multi-factor authentication.
                        </div>
                    `;
                }
                
            } catch (error) {
                authManager.showAlert('Failed to load profile: ' + error.message, 'error');
            }
        }
        
        // MFA Setup Handler
        document.getElementById('setup-mfa-btn').addEventListener('click', async () => {
            const button = document.getElementById('setup-mfa-btn');
            authManager.setOriginalButtonText(button);
            authManager.showLoading(button);
            
            try {
                await mfaManager.setupTOTP();
                document.getElementById('mfa-setup-section').classList.add('hidden');
                document.getElementById('mfa-setup-process').classList.remove('hidden');
                
            } catch (error) {
                authManager.showAlert('Failed to setup MFA: ' + error.message, 'error');
            } finally {
                authManager.showLoading(button, false);
            }
        });
        
        // Verify Setup Handler
        document.getElementById('verify-setup-btn').addEventListener('click', async () => {
            const button = document.getElementById('verify-setup-btn');
            const code = document.getElementById('setup-verification-code').value.trim();
            
            if (!code || code.length !== 6) {
                authManager.showAlert('Please enter a 6-digit code', 'error');
                return;
            }
            
            authManager.setOriginalButtonText(button);
            authManager.showLoading(button);
            
            try {
                await mfaManager.verifyTOTPSetup(code);
                document.getElementById('mfa-setup-process').classList.add('hidden');
                loadProfile(); // Refresh profile to show updated MFA status
                
            } catch (error# LAB: Multi-Factor Authentication (MFA) Implementation

## üéØ **‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå**
- ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Multi-Factor Authentication
- ‡∏ù‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ MFA system ‡∏î‡πâ‡∏ß‡∏¢ HTML, CSS, JavaScript ‡πÅ‡∏•‡∏∞ Node.js
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô TOTP (Time-based One-Time Password)
- ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á OTP ‡∏ú‡πà‡∏≤‡∏ô Email
- ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à security best practices ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ authentication

---

## üìã **‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î Lab**

### **Technology Stack:**
- **Frontend:** HTML5, CSS3, Vanilla JavaScript
- **Backend:** Node.js, Express.js
- **Database:** SQLite (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢)
- **MFA Methods:** 
  - Email OTP
  - TOTP (Google Authenticator compatible)
- **Additional Libraries:**
  - speakeasy (TOTP generation)
  - nodemailer (Email sending)
  - bcrypt (Password hashing)
  - jsonwebtoken (JWT tokens)

### **‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤:** 1 ‡∏ß‡∏±‡∏ô (8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)

---

## üöÄ **Part 1: Project Setup (45 ‡∏ô‡∏≤‡∏ó‡∏µ)**

### **1.1 Initialize Project**
```bash
mkdir mfa-lab
cd mfa-lab

# Initialize Node.js project
npm init -y

# Install dependencies
npm install express sqlite3 bcrypt jsonwebtoken speakeasy nodemailer qrcode
npm install --save-dev nodemon

# Create project structure
mkdir public css js views
touch server.js
touch public/index.html public/login.html public/register.html public/dashboard.html
touch css/style.css
touch js/auth.js js/mfa.js
```

### **1.2 Package.json Scripts**
```json
{
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  }
}
```

### **‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á project structure
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö `npm run dev` ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ

---

## üîß **Part 2: Backend Implementation (2.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)**

### **2.1 Database Setup (30 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**database.js**
```javascript
const sqlite3 = require('sqlite3').verbose();
const bcrypt = require('bcrypt');

class Database {
    constructor() {
        this.db = new sqlite3.Database('mfa_lab.db');
        this.init();
    }

    init() {
        // Users table
        this.db.run(`
            CREATE TABLE IF NOT EXISTS users (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                username TEXT UNIQUE NOT NULL,
                email TEXT UNIQUE NOT NULL,
                password TEXT NOT NULL,
                mfa_enabled BOOLEAN DEFAULT 0,
                mfa_secret TEXT,
                backup_codes TEXT,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP
            )
        `);

        // Login attempts table (for rate limiting)
        this.db.run(`
            CREATE TABLE IF NOT EXISTS login_attempts (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                username TEXT NOT NULL,
                ip_address TEXT NOT NULL,
                success BOOLEAN NOT NULL,
                attempted_at DATETIME DEFAULT CURRENT_TIMESTAMP
            )
        `);

        // Email OTP table
        this.db.run(`
            CREATE TABLE IF NOT EXISTS email_otps (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                user_id INTEGER NOT NULL,
                otp_code TEXT NOT NULL,
                expires_at DATETIME NOT NULL,
                used BOOLEAN DEFAULT 0,
                created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
                FOREIGN KEY (user_id) REFERENCES users (id)
            )
        `);
    }

    // User operations
    async createUser(username, email, password) {
        const hashedPassword = await bcrypt.hash(password, 10);
        return new Promise((resolve, reject) => {
            this.db.run(
                'INSERT INTO users (username, email, password) VALUES (?, ?, ?)',
                [username, email, hashedPassword],
                function(err) {
                    if (err) reject(err);
                    else resolve(this.lastID);
                }
            );
        });
    }

    async getUserByUsername(username) {
        return new Promise((resolve, reject) => {
            this.db.get(
                'SELECT * FROM users WHERE username = ?',
                [username],
                (err, row) => {
                    if (err) reject(err);
                    else resolve(row);
                }
            );
        });
    }

    async updateUserMFA(userId, secret, backupCodes) {
        return new Promise((resolve, reject) => {
            this.db.run(
                'UPDATE users SET mfa_enabled = 1, mfa_secret = ?, backup_codes = ? WHERE id = ?',
                [secret, JSON.stringify(backupCodes), userId],
                function(err) {
                    if (err) reject(err);
                    else resolve(this.changes);
                }
            );
        });
    }

    // Email OTP operations
    async saveEmailOTP(userId, otpCode, expiresAt) {
        return new Promise((resolve, reject) => {
            this.db.run(
                'INSERT INTO email_otps (user_id, otp_code, expires_at) VALUES (?, ?, ?)',
                [userId, otpCode, expiresAt],
                function(err) {
                    if (err) reject(err);
                    else resolve(this.lastID);
                }
            );
        });
    }

    async verifyEmailOTP(userId, otpCode) {
        return new Promise((resolve, reject) => {
            this.db.get(
                `SELECT * FROM email_otps 
                 WHERE user_id = ? AND otp_code = ? AND used = 0 AND expires_at > datetime('now')
                 ORDER BY created_at DESC LIMIT 1`,
                [userId, otpCode],
                (err, row) => {
                    if (err) reject(err);
                    else if (row) {
                        // Mark as used
                        this.db.run('UPDATE email_otps SET used = 1 WHERE id = ?', [row.id]);
                        resolve(true);
                    } else {
                        resolve(false);
                    }
                }
            );
        });
    }

    // Rate limiting
    async logLoginAttempt(username, ipAddress, success) {
        return new Promise((resolve, reject) => {
            this.db.run(
                'INSERT INTO login_attempts (username, ip_address, success) VALUES (?, ?, ?)',
                [username, ipAddress, success],
                function(err) {
                    if (err) reject(err);
                    else resolve(this.lastID);
                }
            );
        });
    }

    async getRecentFailedAttempts(username, ipAddress, minutes = 15) {
        return new Promise((resolve, reject) => {
            this.db.get(
                `SELECT COUNT(*) as count FROM login_attempts 
                 WHERE (username = ? OR ip_address = ?) 
                 AND success = 0 
                 AND attempted_at > datetime('now', '-${minutes} minutes')`,
                [username, ipAddress],
                (err, row) => {
                    if (err) reject(err);
                    else resolve(row.count);
                }
            );
        });
    }
}

module.exports = Database;
```

### **2.2 Email Service (30 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**emailService.js**
```javascript
const nodemailer = require('nodemailer');

class EmailService {
    constructor() {
        // ‡πÉ‡∏ä‡πâ Gmail SMTP (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ environment variables)
        this.transporter = nodemailer.createTransporter({
            service: 'gmail',
            auth: {
                user: process.env.EMAIL_USER || 'your-email@gmail.com',
                pass: process.env.EMAIL_PASS || 'your-app-password'
            }
        });
    }

    generateOTP() {
        return Math.floor(100000 + Math.random() * 900000).toString();
    }

    async sendOTP(email, username, otpCode) {
        const mailOptions = {
            from: process.env.EMAIL_USER || 'your-email@gmail.com',
            to: email,
            subject: 'Your MFA Verification Code',
            html: `
                <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
                    <h2 style="color: #333;">MFA Verification Code</h2>
                    <p>Hello ${username},</p>
                    <p>Your verification code is:</p>
                    <div style="background: #f5f5f5; padding: 20px; text-align: center; font-size: 32px; font-weight: bold; letter-spacing: 5px; margin: 20px 0;">
                        ${otpCode}
                    </div>
                    <p style="color: #666;">This code will expire in 5 minutes.</p>
                    <p style="color: #666;">If you didn't request this code, please ignore this email.</p>
                </div>
            `
        };

        try {
            await this.transporter.sendMail(mailOptions);
            return true;
        } catch (error) {
            console.error('Email sending failed:', error);
            return false;
        }
    }

    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö testing ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏™‡πà‡∏á email ‡∏à‡∏£‡∏¥‡∏á
    async mockSendOTP(email, username, otpCode) {
        console.log(`\n=== MOCK EMAIL ===`);
        console.log(`To: ${email}`);
        console.log(`Subject: Your MFA Verification Code`);
        console.log(`OTP Code: ${otpCode}`);
        console.log(`===================\n`);
        return true;
    }
}

module.exports = EmailService;
```

### **2.3 Main Server (90 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**server.js**
```javascript
const express = require('express');
const path = require('path');
const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');
const speakeasy = require('speakeasy');
const QRCode = require('qrcode');
const Database = require('./database');
const EmailService = require('./emailService');

const app = express();
const PORT = process.env.PORT || 3000;
const JWT_SECRET = process.env.JWT_SECRET || 'your-super-secret-key';

// Initialize services
const db = new Database();
const emailService = new EmailService();

// Middleware
app.use(express.json());
app.use(express.static('public'));
app.use(express.static('css'));
app.use(express.static('js'));

// Rate limiting middleware
const rateLimitMiddleware = async (req, res, next) => {
    const { username } = req.body;
    const ipAddress = req.ip || req.connection.remoteAddress;
    
    const failedAttempts = await db.getRecentFailedAttempts(username, ipAddress);
    
    if (failedAttempts >= 5) {
        return res.status(429).json({ 
            error: 'Too many failed attempts. Please try again in 15 minutes.' 
        });
    }
    
    next();
};

// Routes

// Home page
app.get('/', (req, res) => {
    res.sendFile(path.join(__dirname, 'public', 'index.html'));
});

// Register endpoint
app.post('/api/register', async (req, res) => {
    try {
        const { username, email, password } = req.body;
        
        // Validation
        if (!username || !email || !password) {
            return res.status(400).json({ error: 'All fields are required' });
        }
        
        if (password.length < 8) {
            return res.status(400).json({ error: 'Password must be at least 8 characters' });
        }
        
        // Check if user exists
        const existingUser = await db.getUserByUsername(username);
        if (existingUser) {
            return res.status(400).json({ error: 'Username already exists' });
        }
        
        // Create user
        const userId = await db.createUser(username, email, password);
        
        res.json({ success: true, message: 'User registered successfully', userId });
        
    } catch (error) {
        console.error('Registration error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Login step 1: Username and Password
app.post('/api/login', rateLimitMiddleware, async (req, res) => {
    try {
        const { username, password } = req.body;
        const ipAddress = req.ip || req.connection.remoteAddress;
        
        // Get user
        const user = await db.getUserByUsername(username);
        if (!user) {
            await db.logLoginAttempt(username, ipAddress, false);
            return res.status(401).json({ error: 'Invalid credentials' });
        }
        
        // Verify password
        const passwordValid = await bcrypt.compare(password, user.password);
        if (!passwordValid) {
            await db.logLoginAttempt(username, ipAddress, false);
            return res.status(401).json({ error: 'Invalid credentials' });
        }
        
        // Check if MFA is enabled
        if (!user.mfa_enabled) {
            // Complete login without MFA
            const token = jwt.sign({ userId: user.id, username: user.username }, JWT_SECRET, { expiresIn: '24h' });
            await db.logLoginAttempt(username, ipAddress, true);
            return res.json({ 
                success: true, 
                token, 
                mfaRequired: false,
                message: 'Login successful' 
            });
        }
        
        // Generate temporary token for MFA process
        const tempToken = jwt.sign({ 
            userId: user.id, 
            username: user.username, 
            step: 'mfa_required' 
        }, JWT_SECRET, { expiresIn: '10m' });
        
        res.json({ 
            success: true, 
            tempToken, 
            mfaRequired: true,
            message: 'Please complete MFA verification' 
        });
        
    } catch (error) {
        console.error('Login error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Setup TOTP MFA
app.post('/api/setup-totp', authenticateToken, async (req, res) => {
    try {
        const { userId, username } = req.user;
        
        // Generate secret
        const secret = speakeasy.generateSecret({
            name: `MFA Lab (${username})`,
            issuer: 'MFA Lab'
        });
        
        // Generate backup codes
        const backupCodes = [];
        for (let i = 0; i < 8; i++) {
            backupCodes.push(Math.random().toString(36).substr(2, 8).toUpperCase());
        }
        
        // Generate QR code
        const qrCodeUrl = await QRCode.toDataURL(secret.otpauth_url);
        
        // Store secret temporarily (not yet activated)
        req.session = req.session || {};
        req.session.pendingMFASecret = secret.base32;
        req.session.pendingBackupCodes = backupCodes;
        
        res.json({
            success: true,
            secret: secret.base32,
            qrCode: qrCodeUrl,
            backupCodes: backupCodes
        });
        
    } catch (error) {
        console.error('TOTP setup error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Verify TOTP setup
app.post('/api/verify-totp-setup', authenticateToken, async (req, res) => {
    try {
        const { token } = req.body;
        const { userId } = req.user;
        
        const secret = req.session?.pendingMFASecret;
        const backupCodes = req.session?.pendingBackupCodes;
        
        if (!secret) {
            return res.status(400).json({ error: 'No pending MFA setup found' });
        }
        
        // Verify token
        const verified = speakeasy.totp.verify({
            secret: secret,
            encoding: 'base32',
            token: token,
            window: 2
        });
        
        if (!verified) {
            return res.status(400).json({ error: 'Invalid verification code' });
        }
        
        // Save to database
        await db.updateUserMFA(userId, secret, backupCodes);
        
        // Clear session
        delete req.session?.pendingMFASecret;
        delete req.session?.pendingBackupCodes;
        
        res.json({ success: true, message: 'MFA setup completed successfully' });
        
    } catch (error) {
        console.error('TOTP verification error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Send Email OTP
app.post('/api/send-email-otp', async (req, res) => {
    try {
        const { tempToken } = req.body;
        
        // Verify temp token
        const decoded = jwt.verify(tempToken, JWT_SECRET);
        if (decoded.step !== 'mfa_required') {
            return res.status(401).json({ error: 'Invalid token' });
        }
        
        const user = await db.getUserByUsername(decoded.username);
        if (!user) {
            return res.status(404).json({ error: 'User not found' });
        }
        
        // Generate OTP
        const otpCode = emailService.generateOTP();
        const expiresAt = new Date(Date.now() + 5 * 60 * 1000); // 5 minutes
        
        // Save OTP to database
        await db.saveEmailOTP(user.id, otpCode, expiresAt);
        
        // Send email (use mock for testing)
        const emailSent = await emailService.mockSendOTP(user.email, user.username, otpCode);
        
        if (!emailSent) {
            return res.status(500).json({ error: 'Failed to send email' });
        }
        
        res.json({ success: true, message: 'OTP sent to your email' });
        
    } catch (error) {
        console.error('Email OTP error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Verify MFA (TOTP or Email OTP)
app.post('/api/verify-mfa', async (req, res) => {
    try {
        const { tempToken, code, method } = req.body;
        
        // Verify temp token
        const decoded = jwt.verify(tempToken, JWT_SECRET);
        if (decoded.step !== 'mfa_required') {
            return res.status(401).json({ error: 'Invalid token' });
        }
        
        const user = await db.getUserByUsername(decoded.username);
        if (!user) {
            return res.status(404).json({ error: 'User not found' });
        }
        
        let verified = false;
        
        if (method === 'totp') {
            // Verify TOTP
            verified = speakeasy.totp.verify({
                secret: user.mfa_secret,
                encoding: 'base32',
                token: code,
                window: 2
            });
        } else if (method === 'email') {
            // Verify Email OTP
            verified = await db.verifyEmailOTP(user.id, code);
        } else if (method === 'backup') {
            // Verify backup code
            const backupCodes = JSON.parse(user.backup_codes || '[]');
            verified = backupCodes.includes(code.toUpperCase());
            
            if (verified) {
                // Remove used backup code
                const updatedCodes = backupCodes.filter(c => c !== code.toUpperCase());
                await db.updateUserMFA(user.id, user.mfa_secret, updatedCodes);
            }
        }
        
        if (!verified) {
            const ipAddress = req.ip || req.connection.remoteAddress;
            await db.logLoginAttempt(user.username, ipAddress, false);
            return res.status(401).json({ error: 'Invalid verification code' });
        }
        
        // Generate final auth token
        const token = jwt.sign({ 
            userId: user.id, 
            username: user.username 
        }, JWT_SECRET, { expiresIn: '24h' });
        
        const ipAddress = req.ip || req.connection.remoteAddress;
        await db.logLoginAttempt(user.username, ipAddress, true);
        
        res.json({ success: true, token, message: 'Login successful' });
        
    } catch (error) {
        console.error('MFA verification error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Protected route example
app.get('/api/profile', authenticateToken, async (req, res) => {
    try {
        const user = await db.getUserByUsername(req.user.username);
        if (!user) {
            return res.status(404).json({ error: 'User not found' });
        }
        
        res.json({
            id: user.id,
            username: user.username,
            email: user.email,
            mfaEnabled: user.mfa_enabled,
            createdAt: user.created_at
        });
        
    } catch (error) {
        console.error('Profile error:', error);
        res.status(500).json({ error: 'Internal server error' });
    }
});

// Middleware function
function authenticateToken(req, res, next) {
    const authHeader = req.headers['authorization'];
    const token = authHeader && authHeader.split(' ')[1];
    
    if (!token) {
        return res.status(401).json({ error: 'Access token required' });
    }
    
    jwt.verify(token, JWT_SECRET, (err, user) => {
        if (err) {
            return res.status(403).json({ error: 'Invalid token' });
        }
        req.user = user;
        next();
    });
}

// Session simulation (in production use express-session)
app.use((req, res, next) => {
    req.session = req.session || {};
    next();
});

app.listen(PORT, () => {
    console.log(`Server running on http://localhost:${PORT}`);
});
```

### **‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:**
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API endpoints ‡∏î‡πâ‡∏ß‡∏¢ Postman ‡∏´‡∏£‡∏∑‡∏≠ curl
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á database tables
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ register user
- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ login ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ MFA

---

## üé® **Part 3: Frontend Implementation (2.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)**

### **3.1 Common CSS (30 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**css/style.css**
```css
/* Reset ‡πÅ‡∏•‡∏∞ Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

/* Card Components */
.card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    padding: 40px;
    margin: 20px 0;
    backdrop-filter: blur(10px);
}

.card-header {
    text-align: center;
    margin-bottom: 30px;
}

.card-header h1 {
    color: #333;
    font-size: 2rem;
    margin-bottom: 10px;
}

.card-header p {
    color: #666;
    font-size: 1.1rem;
}

/* Form Styles */
.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    color: #333;
    font-weight: 600;
    margin-bottom: 8px;
}

input[type="text"],
input[type="email"],
input[type="password"],
input[type="number"] {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e1e5e9;
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.3s ease;
}

input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

/* Button Styles */
.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-warning {
    background: #ffc107;
    color: #212529;
}

.btn-block {
    width: 100%;
    margin: 10px 0;
}

/* Alert Styles */
.alert {
    padding: 12px 16px;
    border-radius: 8px;
    margin: 15px 0;
    font-weight: 500;
}

.alert-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-error {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

.alert-info {
    background: #cce7ff;
    color: #004085;
    border: 1px solid #b3d7ff;
}

.alert-warning {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeaa7;
}

/* MFA Specific Styles */
.mfa-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.mfa-option {
    padding: 20px;
    border: 2px solid #e1e5e9;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.mfa-option:hover {
    border-color: #667eea;
    background: #f8f9ff;
}

.mfa-option.selected {
    border-color: #667eea;
    background: #667eea;
    color: white;
}

.qr-code-container {
    text-align: center;
    margin: 20px 0;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
}

.backup-codes {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
}

.backup-codes-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin: 15px 0;
}

.backup-code {
    padding: 8px 12px;
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    font-weight: bold;
    text-align: center;
}

/* Loading Spinner */
.loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid #f3f3f3;
    border-top: 3px solid #667eea;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Responsive Design */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    .card {
        padding: 20px;
        margin: 10px 0;
    }
    
    .card-header h1 {
        font-size: 1.5rem;
    }
    
    .mfa-options {
        grid-template-columns: 1fr;
    }
    
    .backup-codes-grid {
        grid-template-columns: 1fr;
    }
}

/* Utility Classes */
.text-center {
    text-align: center;
}

.text-muted {
    color: #6c757d;
}

.mb-3 {
    margin-bottom: 1rem;
}

.mt-3 {
    margin-top: 1rem;
}

.hidden {
    display: none;
}

.flex {
    display: flex;
}

.justify-center {
    justify-content: center;
}

.items-center {
    align-items: center;
}

.gap-2 {
    gap: 0.5rem;
}
```

### **3.2 Authentication JavaScript (45 ‡∏ô‡∏≤‡∏ó‡∏µ)**

**js/auth.js**
```javascript
class AuthManager {
    constructor() {
        this.baseURL = '';
        this.token = localStorage.getItem('auth_token');